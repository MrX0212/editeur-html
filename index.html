<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Connexion / Inscription</title>
  <style>
    body {
      font-family: monospace;
      background: #f0f0f0;
      margin: 0; padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      text-align: center;
    }
    h1 {
      margin-bottom: 20px;
    }
    .tab {
      margin-bottom: 20px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      background: #4caf50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin-top: 10px;
      width: 220px;
    }
    button:hover {
      background: #45a049;
    }
    input {
      font-size: 16px;
      padding: 10px;
      width: 220px;
      margin: 6px 0;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .error {
      color: red;
      height: 20px;
      margin-top: 5px;
      font-weight: bold;
    }
    #toggleTabs button {
      background: #888;
      margin: 0 5px 20px 5px;
      width: 100px;
    }
    #toggleTabs button.active {
      background: #4caf50;
      color: white;
    }
    form {
      background: white;
      padding: 20px;
      border-radius: 6px;
      box-shadow: 0 0 8px rgba(0,0,0,0.1);
      width: 260px;
    }
  </style>
</head>
<body>

  <h1>Connexion / Inscription</h1>

  <div id="toggleTabs">
    <button id="btnLogin" class="active">Se connecter</button>
    <button id="btnRegister">Créer compte</button>
  </div>

  <form id="loginForm">
    <input type="text" id="loginUsername" placeholder="Nom d’utilisateur" required />
    <input type="password" id="loginPassword" placeholder="Mot de passe" required />
    <button type="submit">Se connecter</button>
    <div class="error" id="loginError"></div>
  </form>

  <form id="registerForm" style="display:none;">
    <input type="text" id="regUsername" placeholder="Nom d’utilisateur" required />
    <input type="password" id="regPassword" placeholder="Mot de passe" required />
    <input type="password" id="regPasswordConfirm" placeholder="Confirmer mot de passe" required />
    <button type="submit">Créer un compte</button>
    <div class="error" id="regError"></div>
  </form>

<script>
  // Gestion onglets connexion / inscription
  const btnLogin = document.getElementById("btnLogin");
  const btnRegister = document.getElementById("btnRegister");
  const loginForm = document.getElementById("loginForm");
  const registerForm = document.getElementById("registerForm");

  btnLogin.onclick = () => {
    btnLogin.classList.add("active");
    btnRegister.classList.remove("active");
    loginForm.style.display = "block";
    registerForm.style.display = "none";
  };

  btnRegister.onclick = () => {
    btnRegister.classList.add("active");
    btnLogin.classList.remove("active");
    registerForm.style.display = "block";
    loginForm.style.display = "none";
  };

  // Register form
  registerForm.onsubmit = e => {
    e.preventDefault();
    const username = document.getElementById("regUsername").value.trim();
    const password = document.getElementById("regPassword").value;
    const confirm = document.getElementById("regPasswordConfirm").value;
    const errorDiv = document.getElementById("regError");
    errorDiv.textContent = "";

    if(username.length < 3) {
      errorDiv.textContent = "Nom d’utilisateur trop court (3+ caractères)";
      return;
    }
    if(password.length < 4) {
      errorDiv.textContent = "Mot de passe trop court (4+ caractères)";
      return;
    }
    if(password !== confirm) {
      errorDiv.textContent = "Les mots de passe ne correspondent pas";
      return;
    }

    let users = JSON.parse(localStorage.getItem("users") || "{}");
    if(users[username]) {
      errorDiv.textContent = "Nom déjà utilisé";
      return;
    }

    users[username] = { password: password };
    localStorage.setItem("users", JSON.stringify(users));
    localStorage.setItem("currentUser", username);
    window.location.href = "editor.html";
  };

  // Login form
  loginForm.onsubmit = e => {
    e.preventDefault();
    const username = document.getElementById("loginUsername").value.trim();
    const password = document.getElementById("loginPassword").value;
    const errorDiv = document.getElementById("loginError");
    errorDiv.textContent = "";

    let users = JSON.parse(localStorage.getItem("users") || "{}");

    if(!users[username] || users[username].password !== password) {
      errorDiv.textContent = "Nom ou mot de passe incorrect";
      return;
    }

    localStorage.setItem("currentUser", username);
    window.location.href = "editor.html";
  };

  // Si déjà connecté, direct à l’éditeur
  if(localStorage.getItem("currentUser")) {
    window.location.href = "editor.html";
  }
</script>

</body>
</html>
